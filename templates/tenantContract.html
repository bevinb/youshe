<div class="easyui-layout" data-options="fit:true">
    <div data-options="region:'center'">
        <div class="easyui-layout" data-options="fit:true">
            <div data-options="region:'north',split:true" style="height:90px;">
                <form class="top-search-form">
                    <input type="hidden" name="CommunityID">
                    <input type="hidden" name="VillageID">
                    <input type="hidden" name="HouseID">
                    <input type="hidden" name="RoomID">
                    <table>
                        <tr>
                            <td>房间：</td>
                            <td><input class="easyui-combotree" data-options="
                    					url:'/YSService/BaseInfoService/GetTree3',
                                        method:'get',
                                        animate:true,
                                        panelHeight: 'auto',
                                        panelWidth: 300,
                                        valueField:'id',
                                        textField:'text',
                                        onClick: ys.modules.TenantContract.onRoomTreeChange
                             " style="width:200px;">
                            </td>
                            <td>房东电话：<input name="phone" class="f1 easyui-textbox" style="width:100px">房东姓名：<input name="phone" class="f1 easyui-textbox" style="width:100px"></td>
                        </tr>
                        <tr>
                            <td>合同编号：</td>
                            <td><input name="phone" class="f1 easyui-textbox" style="width:100px"></td>
                            <td>
                                打款状态：
                                <label><input type="radio" name="pay">已逾期</label>
                                <label><input type="radio" name="pay">本月需打款</label>
                            </td>
                        </tr>
                        <tr>
                            <td></td>
                            <td><input type="button" value="查询" onclick="ys.modules.TenantContract.loadMainData()"></input></td>
                            <td></td>
                        </tr>
                    </table>
                </form>
            </div>
            <div data-options="region:'center'"><table class="main"></table></div>
            <div data-options="region:'south',split:true" style="height:300px;">
                <div class="easyui-tabs" data-options="fit:true,border:false,plain:true">
                    <div title="付款信息" style="padding:10px"><table class="fee"></table></div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="editContractDlg" class="easyui-dialog" style="width:900px;"
     closed="true" data-options="buttons: '#editContractDlgBtns'">
    <div style="padding:10px 60px 20px 60px">
        <form id="fm" method="post" novalidate>
            <table cellpadding="5">
                <tr>
                    <td>房源名称:</td>
                    <td colspan=5><input name="firstname" class="easyui-textbox"></td>
                </tr>
                <tr>
                    <td>所属社区:</td>
                    <td>
                        <input name="lastname" class="easyui-textbox" style="width:150px;" readonly>
                        <span class="label">房源编号:</span><input name="lastname" class="easyui-textbox" style="width:150px;" readonly>
                    </td>
                </tr>
                <tr>
                    <td>小区地址:</td>
                    <td>
                        <input name="lastname" class="easyui-textbox" style="width:70px;" readonly><span class="label">区</span>
                        <input name="lastname" class="easyui-textbox" style="width:70px;" readonly><span class="label">路</span>
                        <input name="lastname" class="easyui-textbox" style="width:70px;" readonly><span class="label">弄（号）</span>
                        <input name="lastname" class="easyui-textbox" style="width:70px;" readonly><span class="label">栋</span>
                        <input name="lastname" class="easyui-textbox" style="width:70px;" readonly><span class="label">单元</span>
                        <input name="lastname" class="easyui-textbox" style="width:70px;" readonly><span class="label">号</span>
                    </td>
                </tr>
                <tr>
                    <td>所在楼层:</td>
                    <td>
                        <input name="lastname" class="easyui-textbox" style="width:70px;" readonly><span class="label">楼</span>
                        <span class="label">共</span><input name="lastname" class="easyui-textbox" style="width:70px;" readonly><span class="label">楼</span>
                    </td>
                </tr>
                <tr>
                    <td>房屋面积:</td>
                    <td>
                        <input name="lastname" class="easyui-textbox" style="width:70px;" readonly><span class="label">室</span>
                        <input name="lastname" class="easyui-textbox" style="width:70px;" readonly><span class="label">厅</span>
                        <input name="lastname" class="easyui-textbox" style="width:70px;" readonly><span class="label">厨</span>
                        <input name="lastname" class="easyui-textbox" style="width:70px;" readonly><span class="label">卫</span>
                        <span class="label">面积</span><input name="lastname" class="easyui-textbox" style="width:70px;" readonly><span class="label">平方米</span>
                    </td>
                </tr>
            </table>
            <hr/>
            <table cellpadding="5">
                <tr>
                    <td>业主姓名:</td>
                    <td><input name="firstname" class="easyui-textbox" style="width:150px;" readonly></td>
                    <td>联系电话:</td>
                    <td><input name="lastname" class="easyui-textbox" style="width:150px;" readonly></td>
                    <td>身份证号:</td>
                    <td><input name="lastname" class="easyui-textbox" style="width:150px;" readonly></td>
                </tr>
                <tr>
                    <td>联系人:</td>
                    <td><input name="lastname" class="easyui-textbox" style="width:150px;" readonly></td>
                    <td>联系方式:</td>
                    <td><input name="lastname" class="easyui-textbox" style="width:150px;" readonly></td>
                    <td></td>
                    <td></td>
                </tr>
            </table>
            <hr/>
            <table cellpadding="5">
                <tr>
                    <td>合同编号:</td>
                    <td>
                        <input name="firstname" class="easyui-textbox" style="width:150px;">
                        <span class="label">房屋接收人:</span><input name="lastname" class="easyui-textbox" style="width:150px;">
                    </td>

                </tr>
                <tr>
                    <td>房屋租金:</td>
                    <td>
                        <input name="lastname" class="easyui-textbox" style="width:150px;">元/月
                        <span class="label">房屋押金:</span><input name="lastname" class="easyui-textbox" style="width:150px;">元/月
                        <span class="label">付款方式:</span>押<select></select>付<select></select>
                    </td>
                </tr>
                <tr>
                    <td>合同周期:</td>
                    <td>
                        <input class="easyui-datebox"></input> ~ <input class="easyui-datebox"></input>
							<span class="label">免租期:<input name="lastname" class="easyui-textbox" style="width:150px;">月
                    </td>
                </tr>
            </table>
        </form>
    </div>
</div>
<div id="editContractDlgBtns">
    <a href="javascript:void(0)" class="easyui-linkbutton c6" iconCls="icon-ok" onclick="javascript:$('.easyui-dialog').dialog('close')" style="width:90px">保存</a>
    <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-cancel" onclick="javascript:$('.easyui-dialog').dialog('close')" style="width:90px">取消</a>
</div>

<script>
    ys.modules.TenantContract =  (function(){
        function loadMainData(){
            var params = $.form2JsonNotNull($('#tenantContractTab').find('.top-search-form'));
            $.ajax({
                url: '/YSService/TenantContractService/GetDataList',
                method: 'POST',
                data: JSON.stringify(params),
                dataType: "json",
                contentType: "application/json; charset=utf-8",
                success: function (resp) {
                    $.each(resp, function(i,item){
                        item['BeginDate'] = $.wcfDate2JsDateStr(item['BeginDate']);
                        item['EndDate'] = $.wcfDate2JsDateStr(item['EndDate']);
                        item['CreateDate'] = $.wcfDate2JsDateStr(item['CreateDate']);
                    });
                    $('#tenantContractTab').find('table.main').datagrid('loadData', {
                        total: resp.length,
                        rows: resp
                    });
                },
                error: function (XMLHttpRequest, textStatus, thrownError) {
                    alert("Error Occured!");
                }
            });
        };

        function onRoomTreeChange(node){
            var form = $('#tenantContractTab').find('.top-search-form');
            if(node.type=='community'){
                form.form('load',{CommunityID:node.id,VillageID:'',HouseID:'',RoomID:''});
            } if(node.type=='village'){
                form.form('load',{CommunityID:'',VillageID:node.id,HouseID:'',RoomID:''});
            } if(node.type=='house'){
                form.form('load',{CommunityID:'',VillageID:'',HouseID:node.id,RoomID:''});
            }
        };


        return {
            onRoomTreeChange: onRoomTreeChange,
            loadMainData: loadMainData
        };
    })();

    window.grid.cfg.tenantContract = {
        singleSelect:true,
        rownumbers: true,
        pagination: true,
        fit: true,
        columns:[[
            {field:'TenantContractNo',title:'合同编号',width:100},
            {field:'ContractStatusName',title:'状态',width:100},
            {field:'BeginDate',title:'开始日期',width:100},
            {field:'EndDate',title:'结束日期',width:100},
            {field:'TenantName',title:'入住人',width:100, formatter:function(v,r){return r.TenantInfo.TenantName;}},
            {field:'Rent',title:'月租金(元)',width:100},
            {field:'Deposit',title:'押金(元)',width:100},
            {field:'Remarks',title:'备注信息',width:100},
            {field:'Creater',title:'录入人',width:100},
            {field:'CreateDate',title:'录入日期',width:100}
        ]]
    };
</script>